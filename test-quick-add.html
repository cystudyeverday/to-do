<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quick Add 测试</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    .test-section {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }

    .test-input {
      width: 100%;
      height: 150px;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .test-button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
    }

    .test-button:hover {
      background: #0056b3;
    }

    .result {
      margin-top: 10px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 4px;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <h1>Quick Add 批量输入功能测试</h1>

  <div class="test-section">
    <h2>测试用例 1: 标准格式</h2>
    <textarea class="test-input" id="test1">1.re-gen topic
2.compliance matrix query / edit
3.valid option now has a showSendBtn boolean
data source view only
4.user management view only view for non-CMP user</textarea>
    <button class="test-button" onclick="testParse('test1')">测试解析</button>
    <div class="result" id="result1"></div>
  </div>

  <div class="test-section">
    <h2>测试用例 2: 不带编号</h2>
    <textarea class="test-input" id="test2">re-gen topic
compliance matrix query / edit
valid option now has a showSendBtn boolean
data source view only
user management view only view for non-CMP user</textarea>
    <button class="test-button" onclick="testParse('test2')">测试解析</button>
    <div class="result" id="result2"></div>
  </div>

  <div class="test-section">
    <h2>测试用例 3: 混合格式</h2>
    <textarea class="test-input" id="test3">1. 第一个任务
不带编号的任务
3. 另一个带编号的任务
最后一个任务</textarea>
    <button class="test-button" onclick="testParse('test3')">测试解析</button>
    <div class="result" id="result3"></div>
  </div>

  <script>
    // 模拟解析函数
    const parseBatchInput = (input) => {
      return input
        .split('\n')
        .map(line => line.trim())
        .filter(line => line.length > 0)
        .map(line => {
          return line.replace(/^\d+\.\s*/, '');
        });
    };

    // 模拟模块分类函数
    const classifyModule = (text) => {
      const lowerText = text.toLowerCase();

      const moduleKeywords = {
        'Compliance': ['compliance', 'matrix', 'query', 'edit', 'regulation', 'policy', 'standard', 'audit', 'validation', 'certification', 'governance', 'risk', 'control'],
        'User Management': ['user', 'management', 'role', 'permission', 'access', 'control', 'rbac', 'user management', 'user admin', 'user profile', 'user settings', 'user account', 'non-cmp', 'cmp'],
        'Data Source': ['data source', 'datasource', 'data management', 'data view', 'view only', 'data access', 'data control', 'data restriction', 'data permission'],
        'Configuration': ['config', 'configuration', 'option', 'valid option', 'showSendBtn', 'boolean', 'property', 'setting', 'parameter', 'flag', 'toggle', 'switch'],
        'Content Management': ['content', 'topic', 're-gen', 'regeneration', 'content management', 'content generation', 'topic generation', 'content update', 'content refresh'],
        'Frontend': ['ui', 'ux', 'interface', 'user', 'client', 'browser', 'react', 'vue', 'angular', 'component', 'page', 'screen', 'view', 'layout', 'design', 'css', 'html', 'javascript', 'typescript', 'frontend', 'client-side'],
        'Backend': ['api', 'server', 'backend', 'service', 'controller', 'route', 'endpoint', 'database', 'model', 'schema', 'query', 'sql', 'nosql', 'mongodb', 'mysql', 'postgresql', 'node', 'express', 'python', 'java', 'php'],
        'Database': ['database', 'db', 'table', 'schema', 'migration', 'query', 'sql', 'nosql', 'mongodb', 'mysql', 'postgresql', 'redis', 'index', 'constraint', 'foreign key', 'primary key', 'relationship'],
        'Testing': ['test', 'testing', 'unit', 'integration', 'e2e', 'end-to-end', 'spec', 'jest', 'mocha', 'cypress', 'selenium', 'coverage', 'mock', 'stub', 'fixture'],
        'Security': ['security', 'auth', 'authentication', 'authorization', 'login', 'logout', 'password', 'token', 'jwt', 'oauth', 'encryption', 'hash', 'bcrypt', 'ssl', 'https', 'vulnerability', 'xss', 'csrf', 'sql injection'],
        'DevOps': ['deploy', 'deployment', 'ci', 'cd', 'pipeline', 'docker', 'kubernetes', 'aws', 'azure', 'gcp', 'server', 'infrastructure', 'monitoring', 'logging', 'alert', 'backup', 'restore'],
        'UI/UX': ['ui', 'ux', 'design', 'user experience', 'interface', 'wireframe', 'prototype', 'mockup', 'user flow', 'interaction', 'usability', 'accessibility', 'responsive', 'mobile', 'desktop']
      };

      for (const [moduleName, keywords] of Object.entries(moduleKeywords)) {
        for (const keyword of keywords) {
          if (lowerText.includes(keyword.toLowerCase())) {
            return moduleName;
          }
        }
      }

      return 'Other';
    };

    function testParse(testId) {
      const input = document.getElementById(testId).value;
      const resultDiv = document.getElementById('result' + testId.slice(-1));

      console.log('Testing input:', input);

      const tasks = parseBatchInput(input);
      console.log('Parsed tasks:', tasks);

      let result = `解析结果 (${tasks.length} 个任务):\n\n`;

      tasks.forEach((task, index) => {
        const module = classifyModule(task);
        result += `${index + 1}. "${task}"\n   模块: ${module}\n\n`;
      });

      resultDiv.textContent = result;
    }
  </script>
</body>

</html>